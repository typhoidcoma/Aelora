# =============================================================================
# Aelora ðŸ¦‹ â€” settings.yaml
# Copy this file to settings.yaml and fill in your values.
# =============================================================================

# --- General ---

# IANA timezone for the server. Affects cron jobs, logs, and date formatting.
# Examples: America/New_York, America/Chicago, America/Los_Angeles,
#           Europe/London, Asia/Tokyo, UTC
timezone: "UTC"

# --- Discord ---

discord:
  token: "YOUR_DISCORD_BOT_TOKEN"

  # How the bot responds in guild (server) channels:
  #   "mention" â€” only replies when @mentioned (recommended)
  #   "all"     â€” replies to every message in allowed channels
  guildMode: "mention"

  # Restrict to specific channel IDs (empty = all channels).
  allowedChannels: []

  # Whether to respond to direct messages.
  allowDMs: true

  # Status message shown under the bot's name in Discord.
  status: "Watching the void"

  # Guild ID for instant slash-command registration (dev only).
  # Omit for global registration (propagates in ~1 hour).
  # guildId: "YOUR_GUILD_ID"

  # Custom embed accent color (hex). Omit for Discord blurple.
  # embedColor: "#5865F2"

  # Channel ID for crash/restart notifications. Omit to disable.
  # statusChannelId: "YOUR_CHANNEL_ID"

# --- LLM ---
# Any OpenAI-compatible endpoint works (OpenAI, Ollama, OpenRouter,
# Together, Groq, LM Studio, xAI/Grok, etc.).

llm:
  baseURL: "https://api.openai.com/v1"
  apiKey: "sk-YOUR_API_KEY"
  model: "gpt-4o-mini"

  # Fallback system prompt when the persona system is disabled.
  systemPrompt: "You are a helpful Discord bot. Be concise."

  # Max tokens per LLM response.
  maxTokens: 1024

  # How many previous messages to keep in conversation history per channel.
  maxHistory: 20

  # Max tool-calling rounds per LLM request (prevents infinite loops).
  # maxToolIterations: 10

  # Enable lite mode for small local models (e.g. 4B, 7B).
  # Shortens tool descriptions and trims the system prompt to reduce
  # input tokens. Tools still work, just with less verbose schemas.
  # lite: true

# --- Persona ---
# Composes the bot's system prompt from markdown files in a persona directory.
# Each file uses YAML frontmatter (order, enabled, label, section) + markdown body.
# When enabled, overrides llm.systemPrompt above.

persona:
  enabled: true
  dir: "persona"            # Path to persona directory (relative to project root)
  botName: "Aelora"         # Substituted into {{botName}} placeholders
  activePersona: "aelora"   # Which subfolder to load (e.g. aelora, wendy, batperson)

# --- Tools ---
# API keys and config for tools. Each tool declares what it needs.

tools: {}
  # brave:
  #   apiKey: "YOUR_BRAVE_API_KEY"

  # CalDAV (Radicale) â€” required for calendar and todo tools.
  # See README.md for Radicale setup instructions.
  # caldav:
  #   serverUrl: "http://127.0.0.1:5232"
  #   username: "aelora"
  #   password: "aelora123"
  #   authMethod: "Basic"       # Basic, Oauth, or Bearer
  #   calendarName: "Aelora"    # Must match the calendar name on the server

  # Google Workspace â€” required for gmail, google_calendar, google_docs, google_tasks tools.
  # Uses OAuth2 refresh token flow. See ARCHITECTURE.md for setup details.
  # google:
  #   clientId: "YOUR_GOOGLE_CLIENT_ID"
  #   clientSecret: "YOUR_GOOGLE_CLIENT_SECRET"
  #   refreshToken: "YOUR_REFRESH_TOKEN"

# --- Agents ---
# Sub-agents that perform multi-step tasks with LLM reasoning + tools.
# Auto-discovered from src/agents/.

agents:
  enabled: true
  maxIterations: 5          # Max LLM iterations per agent run

# --- Heartbeat ---
# Periodic pulse that runs registered handlers (calendar reminders,
# memory compaction, etc.). Separate from cron.

heartbeat:
  enabled: true
  intervalMs: 60000         # Tick interval in ms (default: 60s)

# --- Web Dashboard ---

web:
  enabled: true
  port: 3000

  # API key for authenticating dashboard/API requests.
  # When set, /api/* routes (except /api/status) require
  # an Authorization: Bearer <key> header.
  # apiKey: "your-secret-api-key"

# --- Memory ---
# Controls per-user/channel fact storage behavior.

memory:
  maxFactsPerScope: 100       # Max facts per scope (user, channel, global)
  maxFactLength: 1000         # Max characters per individual fact
  maxAgeDays: 0               # Auto-prune facts older than N days (0 = keep forever)

# --- Logger ---
# Controls console capture and optional file logging.

logger:
  maxBuffer: 200              # SSE circular buffer size (log entries kept in memory)
  fileEnabled: false           # Write logs to data/logs/YYYY-MM-DD.log
  retainDays: 7               # How many days of log files to keep (auto-rotation)

# --- Cron ---
# Controls scheduled job behavior.

cron:
  maxHistory: 10              # Max execution history records per cron job

# --- Discord Activity ---
# Embed a web app (e.g. Unity WebGL) as a Discord Activity.
# Requires Activities enabled in the Discord Developer Portal.
# Place build files in the activity/ directory at project root.

activity:
  enabled: false
  clientId: "YOUR_APPLICATION_ID"
  clientSecret: "YOUR_CLIENT_SECRET"
  # serverUrl: "https://your-tunnel.example.com"
